<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„è½®å›</title>
    <style>
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #0d1117; color: #c9d1d9; display: flex; justify-content: center; padding: 20px; line-height: 1.6; }
        #game-container { max-width: 700px; width: 100%; background: #161b22; padding: 30px; border-radius: 12px; border: 1px solid #30363d; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        h1 { color: #58a6ff; text-align: center; border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-top: 0; }
        .stats { display: flex; justify-content: space-between; background: #21262d; padding: 12px; border-radius: 6px; margin-bottom: 20px; color: #8b949e; font-size: 0.9em; }
        .content { font-size: 1.1em; margin-bottom: 25px; min-height: 180px; white-space: pre-wrap; }
        .choices { display: flex; flex-direction: column; gap: 12px; }
        button { background: #238636; color: white; border: 1px solid rgba(240,246,252,0.1); padding: 14px; border-radius: 6px; cursor: pointer; font-size: 1em; text-align: left; transition: 0.2s; }
        button:hover:not(:disabled) { background: #2ea043; transform: translateX(5px); }
        button:disabled { background: #30363d; color: #8b949e; cursor: not-allowed; opacity: 0.6; }
        .highlight { color: #ffa657; font-weight: bold; }
        .badge { background: #f1e05a; color: #000; padding: 2px 6px; border-radius: 4px; font-size: 0.8em; margin-left: 5px; }
    </style>
</head>
<body>

<div id="game-container">
    <h1>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„è½®å›</h1>
    <div class="stats">
        <span>ğŸ§  è„‘åŠ›: <span id="mp">100</span></span>
        <span>ğŸ’ è£…å¤‡: <span id="item">æ­£åœ¨åˆå§‹åŒ–...</span></span>
        <span>ğŸ“ è¿›åº¦: <span id="step">1</span>/10</span>
    </div>
    <div id="scene-text" class="content"></div>
    <div id="choice-buttons" class="choices"></div>
</div>

<script>
    // æ£€æŸ¥é€šå…³çŠ¶æ€
    let hasCleared = localStorage.getItem('gameCleared') === 'true';
    
    // åˆå§‹åŒ–æ¸¸æˆçŠ¶æ€
    let state = {
        mp: 100,
        item: hasCleared ? "è–„è·ç³–" : "ç‰©ç†è¯¾æœ¬",
        step: 1
    };

    const story = {
        1: {
            getText: () => hasCleared ? 
                "ä½ å†æ¬¡åœ¨å‘å…‰çš„çœŸèŒä¸›ä¸­é†’æ¥ã€‚è‰¾ç³ä¾ç„¶æ¡ç€é•¿å¼“ã€‚ç”±äºä½ æ›¾è¾¾æˆå›å½’ç»“å±€ï¼Œä½ æƒŠè®¶åœ°å‘ç°å£è¢‹é‡Œç«Ÿç„¶å¸¦ç€é‚£ç›’ã€è–„è·ç³–ã€‘ï¼" : 
                "ä½ é†’åœ¨é­”æ³•æ£®æ—ã€‚ç²¾çµå°‘å¥³è‰¾ç³è®¤ä¸ºä½ æ˜¯é—´è°ã€‚ä½ æ‰‹é‡Œåªæœ‰ä¸€æœ¬ã€Šé«˜ä¸­ç‰©ç†ã€‹ï¼Œè„‘ä¸­å›å“ç€ç‰›é¡¿çš„æ•™è¯²ã€‚",
            getChoices: () => [
                { text: "ã€å…‰å­¦ã€‘åˆ©ç”¨å°é¢åå°„é˜³å…‰åˆ¶é€ 'ç¥è¿¹'", next: 2, effect: { mp: -5 } },
                { text: "ã€å¤–äº¤ã€‘ç”¨è–„è·ç³–è´¿èµ‚å¥¹ï¼ˆé€šå…³å¥–åŠ±ï¼‰", next: 2, effect: { mp: 30, item: "ç²¾çµçš„å‹è°Š" }, disabled: !hasCleared }
            ]
        },
        2: {
            getText: () => "è‰¾ç³æš‚æ—¶ç›¸ä¿¡äº†ä½ ã€‚é€”ä¸­é­é‡è«å¾·é›·çš„æ¯èçŒçŠ¬ï¼å‰æ–¹æ–œå¡æœ‰ä¸€å—å·¨çŸ³ï¼Œå—é‡åŠ›åŠ¿èƒ½ç‰µå¼•ã€‚",
            getChoices: () => [
                { text: "ã€åŠ›å­¦ã€‘åˆ©ç”¨æ æ†åŸç†æ’¬åŠ¨å·¨çŸ³å‹æ­»çŒçŠ¬", next: 3, effect: { mp: -5 } },
                { text: "ã€é€ƒè·‘ã€‘æ¶ˆè€—å¤§é‡ä½“åŠ›å…¨é€Ÿå†²åˆº", next: 3, effect: { mp: -25 } }
            ]
        },
        3: {
            getText: () => "ä½ ä»¬èº²è¿›çŸ®äººçŸ¿é“ï¼Œä¸€å°ç”Ÿé”ˆçš„å®ˆæŠ¤æœºç”²äº®èµ·çº¢ç¯ã€‚å®ƒçš„é€»è¾‘é˜µåˆ—ä¼¼ä¹å¾ˆé™ˆæ—§ã€‚",
            getChoices: () => [
                { text: "ã€é€»è¾‘ã€‘å¤§å–Š'è¯´è°è€…æ‚–è®º'è®©å®ƒé€»è¾‘æ­»é”", next: 4, effect: { mp: -10 } },
                { text: "ã€ç”µè·¯ã€‘ç”¨å›å½¢é’ˆè®©æœºç”²ç”µæ± çŸ­è·¯", next: 4, effect: { mp: -15, item: "ç£é“çŸ¿" } }
            ]
        },
        4: {
            getText: () => "çŸ®äººå·¥åŒ å·´æ—å‡ºç°äº†ï¼ä»–çš„ç†”ç‚‰å› å‹åŠ›ä¸ç¨³å¿«ç‚¸äº†ã€‚ä½ å¯ä»¥å¸®ä»–æ”¹è¿›åŠ¨åŠ›ï¼Œä½†è¿™å†³å®šäº†ä½ åç»­çš„ç§‘æŠ€æ ‘ã€‚",
            getChoices: () => [
                { text: "ã€çƒ­åŠ›å­¦ã€‘å»ºç«‹å†·å‡å®¤ï¼ˆè·å¾—è’¸æ±½å¤–éª¨éª¼ï¼Œæå‡åŠ›é‡ï¼‰", next: 5, effect: { item: "è’¸æ±½å¤–éª¨éª¼" } },
                { text: "ã€ç”µç£å­¦ã€‘ç»•åˆ¶çº¿åœˆï¼ˆè·å¾—æ‰‹æ‘‡å‘ç”µæœºï¼Œè§£é”ç”µåŠ›ï¼‰", next: 5, effect: { item: "æ‰‹æ‘‡å‘ç”µæœº" } }
            ]
        },
        5: {
            getText: () => "è«å¾·é›·çš„é£è¡Œæ¶é­”è¿½æ€è€Œè‡³ã€‚å·´æ—é€’ç»™ä½ ä¸€ä¸ªç‚¸å¼¹ã€‚ä½ éœ€è¦è®¡ç®—æŠ›ç‰©çº¿ã€‚",
            getChoices: () => [
                { text: "ã€é‡åŠ›ã€‘ç²¾å‡†è®¡ç®—è½ç‚¹ï¼Œå°†å…¶æŠ•å‘æ¶é­”ç¾¤", next: 6, effect: { mp: -10 } },
                { text: "ã€æœºæ¢°ã€‘ä¾é å¤–éª¨éª¼çš„åŠ›é‡å¼ºè¡Œæ¨å€’å“¨å¡”", next: 6, effect: { mp: -15 }, disabled: state.item !== "è’¸æ±½å¤–éª¨éª¼" }
            ]
        },
        6: {
            getText: () => "åˆ°è¾¾é»‘çŸ³å ¡å’æŠ¤åŸæ²³ï¼Œæ²³æ°´å¸ƒæ»¡å‰§æ¯’ä¸”æµé€Ÿæå¿«ã€‚æ ¹æ®ä¼¯åŠªåˆ©åŸç†ï¼Œæµé€Ÿè¶Šå¿«å‹å¼ºè¶Šå°ã€‚",
            getChoices: () => [
                { text: "ã€æµä½“åŠ›å­¦ã€‘åˆ©ç”¨æµ®åŠ›åŸç†åˆ¶ä½œç®€æ˜“å–·æ°”èˆ¹", next: 7, effect: { mp: -10 } },
                { text: "ã€ç”µè§£ã€‘åˆ©ç”¨å‘ç”µæœºå°†æ¯’æ°´åˆ†è§£ï¼ˆéœ€è¦å‘ç”µæœºï¼‰", next: 7, effect: { mp: -5 }, disabled: state.item !== "æ‰‹æ‘‡å‘ç”µæœº" }
            ]
        },
        7: {
            getText: () => "æ½œå…¥å ¡å’å†…éƒ¨ï¼ŒçŸ®äººé•¿è€è¢«å…³åœ¨ç¦é­”åŠ›åœºä¸­ã€‚åŠ›åœºæœ¬è´¨æ˜¯é«˜é¢‘ç”µç£éœ‡è¡ã€‚",
            getChoices: () => [
                { text: "ã€ç”µç£å­¦ã€‘åˆ¶ä½œæ³•æ‹‰ç¬¬ç¬¼å±è”½ç”µç£æ”»å‡»", next: 8, effect: { mp: -15 } },
                { text: "ã€çƒ­åŠ›å­¦ã€‘åˆ©ç”¨æç«¯æ¸©å·®è§¦å‘å¡è´å…‹æ•ˆåº”æ–­èƒ½", next: 8, effect: { mp: -10 } }
            ]
        },
        8: {
            getText: () => "è«å¾·é›·ç°èº«ï¼ä»–æ–½å±•äº†ç»å¯¹é›¶åº¦å’’è¯­ï¼Œå‘¨å›´åˆ†å­å‡ ä¹åœæ­¢çƒ­è¿åŠ¨ã€‚ä½ éœ€è¦ç»´æŒä½“æ¸©ã€‚",
            getChoices: () => [
                { text: "ã€èƒ½é‡å®ˆæ’ã€‘é€šè¿‡å¤–éª¨éª¼å‰§çƒˆæ‘©æ“¦äº§çƒ­", next: 9, effect: { mp: -5 }, disabled: state.item !== "è’¸æ±½å¤–éª¨éª¼" },
                { text: "ã€ç‰©ç†æ”»å‡»ã€‘ç”¨å‘ç”µæœºé«˜å‹æ”¾ç”µå‡»ç¢å†°æ™¶", next: 9, effect: { mp: -10 }, disabled: state.item !== "æ‰‹æ‘‡å‘ç”µæœº" }
            ]
        },
        9: {
            getText: () => "ä»ªå¼å°ï¼å››ä¸ªç†µå¢æ”¾å¤§å™¨æ­£åœ¨è¿è¡Œã€‚å®ƒä»¬æ­£ä¸ç”Ÿå‘½ä¹‹æ ‘çš„æ ¹ç³»å‘ç”Ÿè€¦åˆéœ‡åŠ¨ã€‚",
            getChoices: () => [
                { text: "ã€å…±æŒ¯ã€‘å¯»æ‰¾æ”¾å¤§å™¨çš„å›ºæœ‰é¢‘ç‡éœ‡ç¢å®ƒ", next: 10, effect: { mp: -10 } },
                { text: "ã€å…‰å­¦ã€‘åˆ©ç”¨é€é•œç„¦è·çŸ¥è¯†æ±‡èšåœ£å…‰", next: 10, effect: { mp: -15 } }
            ]
        },
        10: {
            getText: () => "è«å¾·é›·ç»æœ›åœ°å†²å‘ä½ ã€‚æœ€åçš„çœŸç†ä¹‹é—¨å³å°†å¼€å¯ã€‚ä½ å†³å®šå¦‚ä½•ç»ˆç»“è¿™ä¸€åˆ‡ï¼Ÿ",
            getChoices: () => [
                { text: "ã€ç»å…¸åŠ›å­¦ã€‘ç”¨å…¨èº«åŠ›é‡æ‰“å‡ºæœ€åä¸€æ‹³", next: "end_hero" },
                { text: "ã€è´¨èƒ½æ–¹ç¨‹ã€‘çƒ§æ¯è¯¾æœ¬é‡Šæ”¾æ ¸èšå˜ï¼ˆå›å½’ç»“å±€ï¼‰", next: "end_god" }
            ]
        },
        "end_hero": {
            getText: () => "ğŸ›¡ï¸ã€ç»“å±€ï¼šé’¢é“è´¤è€…ã€‘ä½ å‡»è´¥äº†å·«å¸ˆã€‚ä½ ç•™åœ¨äº†å¼‚ä¸–ç•Œï¼Œå·´æ—ä¸ºä½ é›•åˆ»äº†å·¨å¤§çš„ç‰›é¡¿åƒã€‚ä½ æ²¡æœ‰å›åˆ°ç°ä»£ï¼Œä½†æˆä¸ºäº†é­”æ³•æ–‡æ˜çš„æ•™çˆ¶ã€‚",
            getChoices: () => [{ text: "å†æ¬¡è½®å›", next: "restart" }]
        },
        "end_god": {
            getText: () => "ğŸŒŒã€ç»“å±€ï¼šç‰©ç†çœŸç¥ã€‘ç™½å…‰åå™¬äº†ä¸€åˆ‡ã€‚ä½ å›åˆ°äº†ç°ä»£çš„è¯¾æ¡Œå‰ï¼Œå£è¢‹é‡Œå´å¤šäº†ä¸€ç›’è–„è·ç³–ã€‚ä½ è§£é”äº†çœŸç†çš„è½®å›ï¼",
            getChoices: () => [{ text: "å¸¦ç€è–„è·ç³–å†æ¬¡ç©¿è¶Š", next: "restart" }]
        }
    };

    function updateStats() {
        document.getElementById('mp').innerText = state.mp;
        document.getElementById('item').innerText = state.item;
        document.getElementById('step').innerText = state.step;
    }

    function renderScene(key) {
        if (key === "restart") {
            if (state.step === "end_god") localStorage.setItem('gameCleared', 'true');
            location.reload();
            return;
        }

        const scene = story[key];
        const textEl = document.getElementById('scene-text');
        const btnEl = document.getElementById('choice-buttons');
        
        textEl.innerText = scene.getText();
        btnEl.innerHTML = '';

        if (state.mp <= 0) {
            textEl.innerHTML = "âŒ <span class='highlight'>è„‘åŠ›è€—å°½ï¼</span>ä½ åœ¨è¯•å›¾æ¨å¯¼éº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ç»„æ—¶æ™•å€’äº†ã€‚è«å¾·é›·å®Œæˆäº†ç¥­å…¸ã€‚";
            const btn = document.createElement('button');
            btn.innerText = "æ—¶å…‰å€’æµï¼ˆé‡æ¥ï¼‰";
            btn.onclick = () => location.reload();
            btnEl.appendChild(btn);
            return;
        }

        scene.getChoices().forEach(c => {
            const btn = document.createElement('button');
            btn.innerText = c.text;
            if (c.disabled) btn.disabled = true;
            btn.onclick = () => {
                if (c.effect) {
                    if (c.effect.mp) state.mp += c.effect.mp;
                    if (c.effect.item) state.item = c.effect.item;
                }
                state.step = c.next;
                updateStats();
                renderScene(c.next);
            };
            btnEl.appendChild(btn);
        });
    }

    // å¯åŠ¨æ¸¸æˆ
    updateStats();
    renderScene(1);
</script>
</body>
</html>
