<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„æŒ‘æˆ˜</title>
    <style>
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #0d1117; color: #c9d1d9; display: flex; justify-content: center; padding: 20px; line-height: 1.6; }
        #game-container { max-width: 700px; width: 100%; background: #161b22; padding: 30px; border-radius: 12px; border: 1px solid #30363d; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        h1 { color: #58a6ff; text-align: center; border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-top: 0; }
        .stats { display: flex; justify-content: space-between; background: #21262d; padding: 12px; border-radius: 6px; margin-bottom: 20px; color: #8b949e; font-size: 0.9em; }
        .content { font-size: 1.1em; margin-bottom: 25px; min-height: 180px; white-space: pre-wrap; }
        .choices { display: flex; flex-direction: column; gap: 12px; }
        button { background: #238636; color: white; border: 1px solid rgba(240,246,252,0.1); padding: 14px; border-radius: 6px; cursor: pointer; font-size: 1em; text-align: left; transition: 0.2s; }
        button:hover:not(:disabled) { background: #2ea043; transform: translateX(5px); }
        button:disabled { background: #30363d; color: #8b949e; cursor: not-allowed; opacity: 0.6; }
        .fail-text { color: #f85149; font-weight: bold; }
    </style>
</head>
<body>

<div id="game-container">
    <h1>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„æŒ‘æˆ˜</h1>
    <div class="stats">
        <span>ğŸ§  è„‘åŠ›: <span id="mp">100</span></span>
        <span>ğŸ’ è£…å¤‡: <span id="item">åˆå§‹åŒ–...</span></span>
        <span>ğŸ“ è¿›åº¦: <span id="step">1</span>/10</span>
    </div>
    <div id="scene-text" class="content"></div>
    <div id="choice-buttons" class="choices"></div>
</div>

<script>
    let hasCleared = localStorage.getItem('gameCleared') === 'true';
    let state = { mp: 100, item: hasCleared ? "è–„è·ç³–" : "ç‰©ç†è¯¾æœ¬", step: 1 };

    const story = {
        1: {
            getText: () => hasCleared ? "ä½ å¸¦ç€ã€è–„è·ç³–ã€‘å†æ¬¡é†’æ¥ï¼Œè‰¾ç³çš„è¡¨æƒ…ä¼¼ä¹è½»æ¾äº†ä¸€äº›ã€‚" : "ä½ é†’åœ¨å¼‚ç•Œï¼Œæ‰‹ä¸­åªæœ‰ä¸€æœ¬ç‰©ç†è¯¾æœ¬ã€‚è‰¾ç³æ­£æ€€ç–‘åœ°çœ‹ç€ä½ ã€‚",
            getChoices: () => [
                { text: "ã€å…‰å­¦ã€‘åˆ©ç”¨å°é¢åå°„é˜³å…‰", next: 2, effect: { mp: -10 } },
                { text: "ã€å¤–äº¤ã€‘é€’å‡ºè–„è·ç³–", next: 2, effect: { mp: 20, item: "ç²¾çµçš„ä¿¡èµ–" }, disabled: !hasCleared }
            ]
        },
        2: {
            getText: () => "æ¯èçŒçŠ¬è¢­æ¥ï¼å‰æ–¹æœ‰å·¨çŸ³ã€‚",
            getChoices: () => [
                { text: "ã€åŠ›å­¦ã€‘æ’¬åŠ¨å·¨çŸ³", next: 3, effect: { mp: -10 } },
                { text: "ã€è½æ’ã€‘è¯•å›¾ç©ºæ‰‹ææ–—", next: "fail_physics_1" }
            ]
        },
        3: {
            getText: () => "çŸ¿é“æœºç”²é˜»è·¯ï¼Œå®ƒçš„é€»è¾‘æ ¸å¿ƒæ­£åœ¨å‘çƒ­ã€‚",
            getChoices: () => [
                { text: "ã€é€»è¾‘ã€‘æ‚–è®ºæ‰“å‡»", next: 4, effect: { mp: -15 } },
                { text: "ã€å¼ºæ‹†ã€‘æš´åŠ›ç ´æ‹†ï¼ˆè„‘åŠ›æ¶ˆè€—æå¤§ï¼‰", next: 4, effect: { mp: -50 } }
            ]
        },
        4: {
            getText: () => "å·´æ—çš„ç†”ç‚‰å‹åŠ›çˆ†è¡¨ï¼ä½ éœ€è¦ç«‹åˆ»è®¡ç®—å®‰å…¨é˜ˆå€¼ã€‚",
            getChoices: () => [
                { text: "ã€çƒ­åŠ›å­¦ã€‘å†·å‡å‡å‹", next: 5, effect: { item: "è’¸æ±½å¤–éª¨éª¼", mp: -10 } },
                { text: "ã€é”™è¯¯æ“ä½œã€‘å¼ºè¡Œå…³é—­é˜€é—¨å¯¼è‡´çˆ†ç‚¸", next: "fail_physics_2" }
            ]
        },
        5: {
            getText: () => "é¢å¯¹é£è¡Œæ¶é­”ï¼Œå·´æ—ç»™äº†ä½ ç‚¸å¼¹ã€‚",
            getChoices: () => [
                { text: "ã€é‡åŠ›ã€‘æŠ›ç‰©çº¿ç²¾å‡†æŠ•æ·", next: 6, effect: { mp: -10 } },
                { text: "ã€ç›²ç›®æŠ•æ·ã€‘è¢«æ¶é­”åå¼¹ç‚¸è¯", next: "fail_physics_3" }
            ]
        },
        6: {
            getText: () => "å‰§æ¯’æŠ¤åŸæ²³æ‹¦è·¯ã€‚",
            getChoices: () => [
                { text: "ã€æµä½“åŠ›å­¦ã€‘åˆ¶é€ å–·æ°”èˆ¹", next: 7, effect: { mp: -15 } },
                { text: "ã€é²è½ã€‘ç›´æ¥æ³…æ¸¡", next: "fail_physics_4" }
            ]
        },
        7: {
            getText: () => "åŠ›åœºå›šç¬¼å…³ç€é•¿è€ã€‚",
            getChoices: () => [
                { text: "ã€ç”µç£å­¦ã€‘æ³•æ‹‰ç¬¬ç¬¼", next: 8, effect: { mp: -15 } },
                { text: "ã€è›®åŠ›ã€‘ç”¨æ‰‹æ‹‰æ‰¯ç”µç£æ …æ ", next: "fail_physics_5" }
            ]
        },
        8: {
            getText: () => "è«å¾·é›·é‡Šæ”¾ç»å¯¹é›¶åº¦ï¼",
            getChoices: () => [
                { text: "ã€æ‘©æ“¦ç”Ÿçƒ­ã€‘å¿«é€Ÿè¿åŠ¨ï¼ˆéœ€å¤–éª¨éª¼ï¼‰", next: 9, effect: { mp: -10 }, disabled: state.item !== "è’¸æ±½å¤–éª¨éª¼" },
                { text: "ã€ä»¥ç«æ”»å†°ã€‘æ™®é€šçš„ç«æŠŠï¼ˆç¬é—´ç†„ç­ï¼‰", next: "fail_physics_6" }
            ]
        },
        9: {
            getText: () => "æ”¾å¤§å™¨å…±æŒ¯ä¸­ï¼Œé¢‘ç‡å³å°†è¾¾åˆ°ä¸´ç•Œç‚¹ã€‚",
            getChoices: () => [
                { text: "ã€å…±æŒ¯ã€‘ç›¸ä½å¯¹å†²éœ‡ç¢å®ƒ", next: 10, effect: { mp: -15 } },
                { text: "ã€èŠ‚å¥é”™è¯¯ã€‘å¼•å‘æ›´å¤§è§„æ¨¡çš„çˆ†ç‚¸", next: "fail_physics_7" }
            ]
        },
        10: {
            getText: () => "è«å¾·é›·æœ€åçš„ä¸€å‡»ã€‚ä½ è¦å¼€å¯æ ¸èšå˜å—ï¼Ÿ",
            getChoices: () => [
                { text: "ã€ç»å…¸åŠ›å­¦ã€‘æœ€åçš„é“æ‹³", next: "end_hero" },
                { text: "ã€è´¨èƒ½æ–¹ç¨‹ã€‘çœŸç†è§‰é†’ï¼ˆå›å½’ç»“å±€ï¼‰", next: "end_god" }
            ]
        },
        // å¤±è´¥ç»“å±€é›†é”¦
        "fail_physics_1": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šç”Ÿç‰©ç›´è§‰ç¼ºå¤±ã€‘</span>ä½ è¯•å›¾ç”¨è‚‰èº«å¯¹æŠ—æ­»çµç”Ÿç‰©ã€‚ä½ é†’åœ¨ç°ä»£åŒ»é™¢ï¼ŒåŒ»ç”Ÿè¯´ä½ å› å‹åŠ›è¿‡å¤§åœ¨ç‰©ç†è¯¾ä¸Šæ™•å€’äº†ã€‚ä½ æ²¡æœ‰è·å¾—ä»»ä½•å¥–åŠ±ã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_2": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šå‹åŠ›çˆ†ç‚¸ã€‘</span>ç”±äºä½ æ²¡è€ƒè™‘æ³¢ä¹‰è€³å®šå¾‹ï¼Œç†”ç‚‰ç‚¸äº†ã€‚ä½ å›åˆ°äº†åœ°çƒï¼Œæ­£åœ¨è¡¥è€ƒçƒ­åŠ›å­¦ã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_3": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šè½¨è¿¹è¯¯å·®ã€‘</span>ç‚¸å¼¹æ²¡å‡»ä¸­æ¶é­”åè€Œç‚¸å¡Œäº†æ‚¬å´–ã€‚ä½ é†’æ¥æ—¶å‘ç°è‡ªå·±æ­£è¶´åœ¨ç‰©ç†è¯•å·ä¸Šã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_4": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šç”ŸåŒ–æ¸—é€ã€‘</span>æ¯’æ°´ç¬é—´éº»ç—¹äº†ä½ ã€‚ä½ å›åˆ°äº†ç°å®ä¸–ç•Œï¼Œæ­£åœ¨æŸ¥é˜…åŒ–å­¦å…ƒç´ å‘¨æœŸè¡¨ã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_5": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šè§¦ç”µäº‹æ•…ã€‘</span>ä½ è¢«é«˜å‹ç”µçƒ§ç„¦äº†ã€‚ä½ å›åˆ°åœ°çƒï¼Œç”±äºè§¦ç”µææƒ§ç—‡ï¼Œä½ å†ä¹Ÿä¸æ•¢ä¿®æ’åº§äº†ã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_6": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šå¤±æ¸©ã€‘</span>çƒ­é‡æµå¤±å¤ªå¿«ã€‚ä½ é†’æ¥æ—¶æ­£æŠ±ç€æš–æ°”ç‰‡ï¼Œä»¥ä¸ºè‡ªå·±è¿˜åœ¨å¼‚ç•Œã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "fail_physics_7": { getText: () => "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šé¢‘ç‡å¤±æ§ã€‘</span>ç”±äºç›¸ä½è®¡ç®—é”™è¯¯ï¼Œä½ æŠŠè‡ªå·±éœ‡é£äº†ã€‚ä½ å›åˆ°äº†ç°å®ä¸­çš„è€ƒåœºã€‚", choices: [{ text: "é‡å¤´å†æ¥", next: "restart_no_reward" }] },
        "end_hero": { getText: () => "ğŸ›¡ï¸ã€ç»“å±€ï¼šé’¢é“è´¤è€…ã€‘ä½ å‡»è´¥äº†è«å¾·é›·ï¼ä½ ç•™åœ¨äº†å¼‚ç•Œã€‚è™½ç„¶æ²¡å¸¦å›è–„è·ç³–ï¼Œä½†ä½ æ˜¯è¿™é‡Œçš„è‹±é›„ã€‚", choices: [{ text: "é‡ç©", next: "restart_no_reward" }] },
        "end_god": { getText: () => "ğŸŒŒã€ç»“å±€ï¼šç‰©ç†çœŸç¥ã€‘ä½ æ”¹å†™äº†å®‡å®™ã€‚ä½ é†’åœ¨è¯¾æ¡Œå‰ï¼Œå£è¢‹é‡Œå¤šäº†ã€è–„è·ç³–ã€‘ï¼", choices: [{ text: "å¼€å¯äºŒå‘¨ç›®", next: "restart_with_reward" }] }
    };

    function updateStats() {
        document.getElementById('mp').innerText = state.mp;
        document.getElementById('item').innerText = state.item;
        document.getElementById('step').innerText = state.step;
    }

    function renderScene(key) {
        if (key === "restart_with_reward") { localStorage.setItem('gameCleared', 'true'); location.reload(); return; }
        if (key === "restart_no_reward") { location.reload(); return; }

        const scene = story[key];
        const textEl = document.getElementById('scene-text');
        const btnEl = document.getElementById('choice-buttons');
        
        textEl.innerHTML = scene.getText();
        btnEl.innerHTML = '';

        if (state.mp <= 0) {
            textEl.innerHTML = "âŒ <span class='fail-text'>ã€å¤±è´¥ï¼šè„‘åŠ›è€—å°½ã€‘</span>ä½ çš„å¤§è„‘å› è¶…è´Ÿè·è®¡ç®—è€Œå®•æœºã€‚ä½ å›åˆ°äº†åœ°çƒï¼Œæ­£åœ¨å¤è¯»ã€‚";
            const btn = document.createElement('button');
            btn.innerText = "é‡æ–°å¼€å§‹";
            btn.onclick = () => location.reload();
            btnEl.appendChild(btn);
            return;
        }

        scene.getChoices().forEach(c => {
            const btn = document.createElement('button');
            btn.innerText = c.text;
            if (c.disabled) btn.disabled = true;
            btn.onclick = () => {
                if (c.effect) {
                    if (c.effect.mp) state.mp += c.effect.mp;
                    if (c.effect.item) state.item = c.effect.item;
                }
                state.step = c.next;
                updateStats();
                renderScene(c.next);
            };
            btnEl.appendChild(btn);
        });
    }

    updateStats();
    renderScene(1);
</script>
</body>
</html>
