<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <titleå¼‚ç•Œçš„å‹‡è€…ï¼šç‰©ç†å­¦æ‹¯æ•‘ä¸–ç•Œ</title>
    <style>
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #0d1117; color: #c9d1d9; display: flex; justify-content: center; padding: 20px; line-height: 1.6; }
        #game-container { max-width: 700px; width: 100%; background: #161b22; padding: 30px; border-radius: 12px; border: 1px solid #30363d; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        h1 { color: #58a6ff; text-align: center; border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-top: 0; }
        .stats { display: flex; justify-content: space-between; background: #21262d; padding: 12px; border-radius: 6px; margin-bottom: 20px; color: #8b949e; font-size: 0.9em; }
        .content { font-size: 1.1em; margin-bottom: 25px; min-height: 180px; white-space: pre-wrap; }
        .choices { display: flex; flex-direction: column; gap: 12px; }
        button { background: #238636; color: white; border: 1px solid rgba(240,246,252,0.1); padding: 14px; border-radius: 6px; cursor: pointer; font-size: 1em; text-align: left; transition: 0.2s; }
        button:hover:not(:disabled) { background: #2ea043; transform: translateX(5px); }
        button:disabled { background: #30363d; color: #8b949e; cursor: not-allowed; opacity: 0.6; }
        .fail-text { color: #f85149; font-weight: bold; }
        .quiz-box { background: #0d1117; border: 1px dashed #58a6ff; padding: 15px; margin-top: 20px; border-radius: 8px; }
        .intro-text { color: #8b949e; font-style: italic; border-left: 3px solid #58a6ff; padding-left: 15px; margin-bottom: 20px; }
    </style>
</head>
<body>

<div id="game-container">
    <h1>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„æŒ‘æˆ˜</h1>
    <div class="stats">
        <span>ğŸ§  è„‘åŠ› (MP): <span id="mp">100</span></span>
        <span>ğŸ’ è£…å¤‡: <span id="item">åˆå§‹åŒ–...</span></span>
        <span>ğŸ“ è¿›åº¦: <span id="step">1</span>/10</span>
    </div>
    <div id="scene-text" class="content"></div>
    <div id="choice-buttons" class="choices"></div>
</div>

<script>
    let hasCleared = localStorage.getItem('gameCleared') === 'true';
    let state = { mp: 100, item: hasCleared ? "è–„è·ç³–" : "ç‰©ç†è¯¾æœ¬", step: 0 };

    const physicsQuiz = [
        { q: "å½“ä¸€ä¸ªç‰©ä½“åšåŒ€é€Ÿåœ†å‘¨è¿åŠ¨æ—¶ï¼Œä¸‹åˆ—å“ªä¸ªç‰©ç†é‡æ˜¯ä¸å˜çš„ï¼Ÿ", a: ["é€Ÿç‡", "é€Ÿåº¦", "åŠ é€Ÿåº¦", "åˆå¤–åŠ›"], correct: 0 },
        { q: "æ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼ŒåŠ›ã€è´¨é‡ã€åŠ é€Ÿåº¦çš„å…³ç³»æ˜¯ï¼Ÿ", a: ["F=m/a", "F=ma", "m=Fa", "a=m/F"], correct: 1 },
        { q: "ä¸€ä¸ªè‹¹æœä»æ ‘ä¸Šè‡ªç”±è½ä¸‹ï¼Œä¸è®¡ç©ºæ°”é˜»åŠ›ï¼Œå®ƒçš„ï¼Ÿ", a: ["åŠ¨èƒ½ä¸å˜", "é‡åŠ›åŠ¿èƒ½å¢åŠ ", "æœºæ¢°èƒ½å®ˆæ’", "é€Ÿåº¦ä¿æŒä¸å˜"], correct: 2 },
        { q: "ä¸‹åˆ—å“ªç§ç°è±¡å±äºå…‰çš„æŠ˜å°„ï¼Ÿ", a: ["æ°´ä¸­çš„å€’å½±", "å°å­”æˆåƒ", "å½©è™¹çš„å½¢æˆ", "é•œå­é‡Œçš„åƒ"], correct: 2 },
        { q: "çƒ­åŠ›å­¦ç¬¬ä¸€å®šå¾‹æè¿°çš„æ˜¯ï¼Ÿ", a: ["èƒ½é‡å®ˆæ’", "ç»å¯¹é›¶åº¦ä¸å¯è¾¾åˆ°", "ç†µå¢åŸç†", "åˆ†å­çƒ­è¿åŠ¨"], correct: 0 },
        { q: "ç”µæµå¼ºåº¦çš„å›½é™…å•ä½æ˜¯ï¼Ÿ", a: ["ä¼ç‰¹", "æ¬§å§†", "å®‰åŸ¹", "ç“¦ç‰¹"], correct: 2 },
        { q: "åœ¨çœŸç©ºä¸­ï¼Œæ‰€æœ‰ç”µç£æ³¢çš„ä»€ä¹ˆç‰©ç†é‡æ˜¯ç›¸åŒçš„ï¼Ÿ", a: ["é¢‘ç‡", "æ³¢é•¿", "æ³¢é€Ÿ", "èƒ½é‡"], correct: 2 },
        { q: "ç¬¬ä¸€ä¸ªé€šè¿‡å®éªŒæµ‹å‡ºä¸‡æœ‰å¼•åŠ›å¸¸é‡çš„ç§‘å­¦å®¶æ˜¯ï¼Ÿ", a: ["ç‰›é¡¿", "å¼€æ™®å‹’", "å¡æ–‡è¿ªè®¸", "ä¼½åˆ©ç•¥"], correct: 2 },
        { q: "åœ¨æè¿°ç®€è°è¿åŠ¨æ—¶ï¼Œä½ç§»æœ€å¤§æ—¶ï¼Ÿ", a: ["é€Ÿåº¦æœ€å¤§", "åŠ é€Ÿåº¦æœ€å¤§", "åŠ¨èƒ½æœ€å¤§", "å›å¤åŠ›æœ€å°"], correct: 1 },
        { q: "ä¸‹åˆ—å…³äºæ‘©æ“¦åŠ›çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ", a: ["æ‘©æ“¦åŠ›æ€»æ˜¯é˜»ç¢ç‰©ä½“è¿åŠ¨", "é™æ‘©æ“¦åŠ›ä¸€å®šå¤§äºæ»‘åŠ¨æ‘©æ“¦åŠ›", "æ‘©æ“¦åŠ›æ–¹å‘ä¸€å®šä¸è¿åŠ¨æ–¹å‘ç›¸å", "æ‘©æ“¦åŠ›å¯ä»¥ä½œä¸ºåŠ¨åŠ›"], correct: 3 }
    ];

    const story = {
        0: {
            getText: () => "<div class='intro-text'>ä½ æ˜¯ä¸€åæ™®é€šçš„é«˜ä¸­ç”Ÿï¼Œæ­£ä¸ºç‰©ç†è€ƒè¯•è‹¦æ¼ã€‚åœ¨ä¸€é˜µçœ©å…‰ä¸­ï¼Œä½ æ„å¤–ç©¿è¶Šåˆ°äº†å¼‚ä¸–ç•Œâ€”â€”åŸƒç´¢ä¼¦å¤§é™†ã€‚è¿™é‡Œæ­£é¢ä¸´ç©ºå‰çš„å±æœºï¼šé‚ªæ¶çš„æ­»çµæ³•å¸ˆè«å¾·é›·è¯•å›¾é€šè¿‡çŒ®ç¥­é•¿ç”Ÿä¸è€çš„ç²¾çµæ—æ¥å®ç°æ°¸ç”Ÿã€‚ç²¾çµå°‘å¥³è‰¾ç³åŠ¨ç”¨äº†ä¸Šå¤ç¦å¿Œé­”æ³•å°†èº«ä¸ºâ€œå¼‚ç•Œå‹‡è€…â€çš„ä½ å¬å”¤è‡³æ­¤ã€‚</div>ä½ çš„é€‰æ‹©å°†å†³å®šè¿™ä¸ªä¸–ç•Œçš„å‘½è¿ã€‚ä½ å‡†å¤‡å¥½äº†å—ï¼Ÿ",
            getChoices: () => [
                { text: "å¼€å§‹å†’é™©", next: 1 }
            ]
        },
        1: {
            getText: () => hasCleared ? "ä½ å†æ¬¡é†’æ¥ï¼Œé¢å‰ä»ç„¶æ˜¯ä¸€è„¸æ€€ç–‘çš„è‰¾ç³ã€‚å£è¢‹é‡Œé‚£å—ã€è–„è·ç³–ã€‘æé†’ç€ä½ ï¼Œè¿™å¹¶éä½ ç¬¬ä¸€æ¬¡æ¥åˆ°è¿™é‡Œã€‚" : "ä½ çŒ›åœ°çå¼€çœ¼ï¼Œé¢å‰æ˜¯ç´§æ¡é•¿å¼“ã€çœ¼ç¥æ€€ç–‘çš„ç²¾çµå°‘å¥³è‰¾ç³ã€‚ä½ æ‰‹é‡Œæ­»æ­»æ”¥ç€çš„åªæœ‰ä¸€æœ¬ã€Šé«˜ä¸­ç‰©ç†ã€‹ã€‚",
            getChoices: () => [
                { text: "å°è¯•ä¸è‰¾ç³æ²Ÿé€š", next: 2, effect: { mp: -5 } },
                { text: "å°†è–„è·ç³–é€ç»™è‰¾ç³ï¼Œè¯•å›¾å¢åŠ å¥½æ„Ÿ", next: 6, effect: { mp: 20, item: "ç²¾çµçš„å‹è°Š" }, disabled: !hasCleared }
            ]
        },
        2: {
            getText: () => "è‰¾ç³å‘Šè¯‰ä½ ï¼Œè«å¾·é›·çš„çˆªç‰™æ­£åœ¨æœæ•ç²¾çµã€‚è¯éŸ³æœªè½ï¼Œä¸€åªæ¯èçŒçŠ¬ä»æš—å¤„è¢­æ¥ï¼ä½ æ³¨æ„åˆ°ä¸Šæ–¹æ–œå¡æ‚¬æŒ‚ç€å·¨çŸ³ã€‚",
            getChoices: () => [
                { text: "å¯»æ‰¾æ”¯ç‚¹ï¼Œåˆ©ç”¨é•¿æœ¨æ’¬åŠ¨å·¨çŸ³è¿›è¡ŒåŠ¿èƒ½æ‰“å‡»", next: 3, effect: { mp: -5 } },
                { text: "ç›´æ¥å†²ä¸Šå‰å»å°è¯•ç”¨æ ¼æ–—å¸å¼•çŒçŠ¬æ³¨æ„", next: "fail_physics_1" }
            ]
        },
        3: {
            getText: () => "å·¨çŸ³ç²¾å‡†å‘½ä¸­ï¼ä½ å’Œè‰¾ç³é€ƒå…¥çŸ®äººçŸ¿é“ã€‚æ·±å¤„ä¸€å°ç”Ÿé”ˆçš„æœºç”²äº®èµ·çº¢å…‰ï¼Œç­‰å¾…æŒ‡ä»¤è¾“å…¥ã€‚",
            getChoices: () => [
                { text: "è¾“å…¥é€»è¾‘æ‚–è®ºä»£ç å°è¯•å¹²æ‰°å…¶æ ¸å¿ƒé˜µåˆ—", next: 4, effect: { mp: -10 } },
                { text: "é€šè¿‡å¯¼çº¿é€ æˆç”µæ± ç»„çŸ­è·¯", next: 4, effect: { mp: -10, item: "ç£é“çŸ¿" } }
            ]
        },
        4: {
            getText: () => "è‰¾ç³è¯·æ±‚çŸ®äººçš„å¸®åŠ©ã€‚çŸ®äººå·´æ—å¯¹ä½ çš„æŠ€è‰ºèµå¹ä¸å·²ã€‚ä»–ç­”åº”å¸®åŠ©ä½ ä»¬ï¼Œä½†éœ€è¦ä½ ä»¬ä¸ºä»–è§£å†³ä¸€ä¸ªéš¾é¢˜ã€‚å·¥åŠä¸­ç†”ç‚‰å› å‹åŠ›è¿‡é«˜å‰§çƒˆéœ‡åŠ¨ï¼ŒæŒ‡é’ˆå·²å…¥çº¢åŒºã€‚",
            getChoices: () => [
                { text: "è®¾è®¡ä¸€ä¸ªå†·å‡åˆ†ç¦»å®¤å¹³è¡¡çƒ­å¾ªç¯", next: 5, effect: { item: "å·´æ—çš„è°¢ç¤¼ï¼šè’¸æ±½å¤–éª¨éª¼", mp: 10 } },
                { text: "æ‰‹åŠ¨æ—‹ç´§ä¿é™©é˜€é—¨å¼ºè¡Œé˜»æ­¢å‹åŠ›æ³„éœ²", next: "fail_physics_2" }
            ]
        },
        5: {
            getText: () => "å°±åœ¨æ­¤æ—¶ï¼Œè«å¾·é›·å‘ç°äº†å¼‚ç•Œå‹‡è€…é™ä¸´çš„è¿¹è±¡ï¼Œé©±ä½¿æŠ¥ä¸§é¸Ÿæ¥ä¼°è®¡ä½ ä»¬ã€‚æŠ¥ä¸§é¸Ÿåœ¨ç©ºä¸­ç›˜æ—‹æ”»å‡»ã€‚å·´æ—å¯ä»¥ä¸ºä½ æä¾›ç®€æ˜“ç‚¸è¯ã€‚",
            getChoices: () => [
                { text: "ä¾æ®æŠ›ç‰©çº¿åŸç†åœ¨å¯¹æ–¹çˆ¬å‡ç‚¹é¢„åˆ¤æŠ•æ·", next: 6, effect: { mp: -5 } },
                { text: "ç›´æ¥ç„å‡†æ¶é­”å¤´éƒ¨è¿›è¡Œé«˜é€Ÿç›´æŠ•", next: "fail_physics_3" }
            ]
        },
        6: {
            getText: () => "è‰¾ç³ä»æœªå°è¿‡å¦‚æ­¤ç”œç¾çš„æ»‹å‘³ï¼Œå¥¹æƒŠå–œåœ°æ¡ä½ä½ çš„æ‰‹ï¼šâ€œæˆ‘çŸ¥é“ä¸€æ¡é¿å¼€è«å¾·é›·è¿½è¸ªçš„æ·å¾„ï¼â€\nå‡»è´¥æŠ¥ä¸§é¸Ÿåï¼Œä½ ä»¬æŠµè¾¾äº†è«å¾·é›·åŸå ¡å¤–çš„å‰§æ¯’æŠ¤åŸæ²³è¾¹ã€‚",
            getChoices: () => [
                { text: "åˆ¶ä½œå¸¦æœ‰é”¥å½¢æ•´æµç½©çš„ç®€æ˜“å–·æ°”å°èˆ¹ï¼Œæ¶ˆè€—è¾ƒå¤šè„‘åŠ›", next: 7, effect: { mp: -5 } },
                { text: "ä¾é ä½“åŠ›å’Œè‰¾ç³çš„é­”æ³•ååŠ©å°è¯•æ³…æ¸¡", next: "fail_physics_4" }
            ]
        },
        7: {
            getText: () => "ä½ ä»¬å‘ç°ä¸€åç²¾çµæ—é•¿è€è¢«å›°åœ¨ç¦é­”åŠ›åœºä¸­ã€‚åŠ›åœºè¡¨é¢é—ªçƒç€æœ‰è§„å¾‹çš„é«˜å‹è„‰åŠ¨ã€‚",
            getChoices: () => [
                { text: "æ„å»ºæ³•æ‹‰ç¬¬ç¬¼è¿›è¡Œé™ç”µå±è”½", next: 8, effect: { mp: -10 } },
                { text: "åˆ©ç”¨æç«¯æ¸©å·®å¯¼è‡´ææ–™ç–²åŠ³ç‚¸ç¢æ ¸å¿ƒ", next: 8, effect: { mp: -10 } }
            ]
        },
        8: {
            getText: () => "ä½ ä»¬çš„è¡ŒåŠ¨è¢«è«å¾·é›·å‘ç°ï¼ä»–æ–½å±•äº†ç»å¯¹é›¶åº¦ã€‚æ¸©åº¦æ€¥å‰§ä¸‹é™ï¼Œåˆ†å­çƒ­è¿åŠ¨è¿‘ä¹åœæ»ã€‚",
            getChoices: () => [
                { text: "å¯åŠ¨å¤–éª¨éª¼è¿‡è½½æ¨¡å¼åˆ©ç”¨æ‘©æ“¦ä¾›çƒ­ï¼Œæ°¸ä¹…å¤±å»ç‰©å“å¤–éª¨éª¼", next: 9, effect: { mp: -10 }, disabled: state.item !== "å·´æ—çš„è°¢ç¤¼ï¼šè’¸æ±½å¤–éª¨éª¼" },
                { text: "ç‚¹ç‡ƒå‘¨å›´å¯ç‡ƒç‰©è¯•å›¾ç»´æŒæ¸©åº¦", next: "fail_physics_6" }
            ]
        },
        9: {
            getText: () => "æš‚æ—¶å‡»é€€è«å¾·é›·åï¼Œä½ ä»¬å‘ç°åŸå ¡æ ¸å¿ƒçš„é­”æ³•é˜µæ­£å¤„äºå…±æŒ¯å·…å³°ï¼Œä¸€æ—¦å¯åŠ¨å°±ä¼šæŠ½å¹²ç²¾çµæ—çš„ç”Ÿå‘½ã€‚ä½ éœ€è¦ç²¾å‡†åœ°å¹²æ‰°å®ƒçš„æ³¢å³°ã€‚",
            getChoices: () => [
                { text: "å‘å°„åå‘ç›¸ä½æ³¢æŸåˆ¶é€ ç›¸æ¶ˆå¹²æ¶‰", next: 10, effect: { mp: -10 } },
                { text: "æå‡èƒ½é‡è¾“å‡ºå°è¯•å¼ºè¡Œéœ‡ç¢é­”æ³•é˜µ", next: "fail_physics_7" }
            ]
        },
        10: {
            getText: () => "ç©ºé—´å¼€å§‹å´©å¡Œã€‚è«å¾·é›·å’†å“®ç€é‡Šæ”¾æ­»äº¡èƒ½é‡ã€‚å¼‚ä¸–ç•Œçš„å‘½è¿åœ¨æ­¤ä¸€ä¸¾ï¼",
            getChoices: () => [
                { text: "è¿ç”¨åŠ¨é‡å®ˆæ’ï¼Œåœ¨å¤–éª¨éª¼åŠ æŒä¸‹æ­£é¢å†²å‡»", next: "end_hero" },
                { text: "ä»¥ç‰©è´¨ä¸ºå¼•é‡Šæ”¾å¾®å‹æ ¸èšå˜", next: "end_god" }
            ]
        },

        "fail_physics_1": { getText: () => "âŒ ä½ è¢«çŒçŠ¬æ‰‘å€’ã€‚ç°ä»£ä¸–ç•Œçš„ä½ åœ¨ç”Ÿç‰©è¯¾ä¸Šè¢«è€å¸ˆç‚¹åå«é†’äº†ã€‚", quiz: true },
        "fail_physics_2": { getText: () => "âŒ å®¹å™¨å› å†…å‹ç¬çˆ†ã€‚ä½ å›åˆ°äº†ç°å®ä¸–ç•Œï¼Œç‰©ç†è€ƒè¯•åªå‰©ä¸‹åäº”åˆ†é’Ÿã€‚", quiz: true },
        "fail_physics_3": { getText: () => "âŒ é‡åŠ›å¯¼è‡´ç‚¸å¼¹è½ç©ºã€‚ä½ è¢«åŒæ¡Œæ‘‡é†’ï¼Œç­ä¸»ä»»æ­£ç«™åœ¨ä½ èº«åã€‚", quiz: true },
        "fail_physics_4": { getText: () => "âŒ ç”±äºå¿½ç•¥æµä½“é˜»åŠ›ï¼Œä½ è¢«æ¿€æµå·èµ°ã€‚ä½ å‘ç°è‡ªå·±åœ¨ç‰©ç†è¯¾ä¸Šæµäº†ä¸€æ¡Œå£æ°´ã€‚", quiz: true },
        "fail_physics_6": { getText: () => "âŒ ã€è´è¶æ•ˆåº”ã€‘ä½ åˆ©ç”¨è–„è·ç³–è·³è¿‡äº†çŸ®äººå…³å¡ï¼Œå´å¤±å»äº†è·å¾—å¤–éª¨éª¼çš„æœºä¼šã€‚åœ¨ç»å¯¹é›¶åº¦é¢å‰ï¼Œä½ å•è–„çš„ç«ç„°ç¬é—´ç†„ç­ã€‚ä½ è¢«å†»é†’åœ¨è€ƒåœºçª—è¾¹ã€‚", quiz: true },
        "fail_physics_7": { getText: () => "âŒ ç›²ç›®è¾“å‡ºå¼•å‘å…±æŒ¯å¤±æ§ã€‚ä½ åœ¨æ™šè‡ªä¹ è¢«å·¡é€»è€å¸ˆæ•²é†’ã€‚", quiz: true },
        "end_hero": { getText: () => "ğŸ›¡ï¸ã€ç»“å±€ï¼šé’¢é“è´¤è€…ã€‘ä½ å‡»è´¥äº†è«å¾·é›·ï¼è™½ç„¶æ²¡èƒ½å¸¦ç€å¥–åŠ±å›å½’ï¼Œä½†ä½ æ”¹å†™äº†å¼‚ä¸–ç•Œçš„å‘½è¿ã€‚", choices: [{ text: "å¼€å¯çœŸç†äºŒå‘¨ç›®", next: "restart_with_reward" }] },
        "end_god": { getText: () => "ğŸŒŒã€ç»“å±€ï¼šç‰©ç†çœŸç¥ã€‘ç™½å…‰ä¹‹åï¼Œä½ é†’åœ¨è¯¾æ¡Œå‰ã€‚å£è¢‹é‡Œå¤šäº†ä¸€ç›’ã€è–„è·ç³–ã€‘ã€‚", choices: [{ text: "å¼€å¯çœŸç†äºŒå‘¨ç›®", next: "restart_with_reward" }] }
    };

    function updateStats() {
        document.getElementById('mp').innerText = state.mp;
        document.getElementById('item').innerText = state.item;
        document.getElementById('step').innerText = state.step;
    }

    function triggerQuiz(failText) {
        const textEl = document.getElementById('scene-text');
        const btnEl = document.getElementById('choice-buttons');
        const randomQuiz = physicsQuiz[Math.floor(Math.random() * physicsQuiz.length)];
        
        textEl.innerHTML = `<span class='fail-text'>${failText}</span><br><div class='quiz-box'><b>âš ï¸ æ—¶ç©ºç¨³å®šç³»ç»Ÿæ•…éšœï¼å›ç­”ç‰©ç†é¢˜ä»¥ä¿®å¤ï¼š</b><br>${randomQuiz.q}</div>`;
        btnEl.innerHTML = '';

        randomQuiz.a.forEach((option, index) => {
            const btn = document.createElement('button');
            btn.innerText = `${String.fromCharCode(65 + index)}. ${option}`;
            btn.onclick = () => {
                if (index === randomQuiz.correct) {
                    alert("å›ç­”æ­£ç¡®ï¼çœŸç†æ„è¯†è‹é†’ï¼Œè·å¾—ã€è–„è·ç³–ã€‘åŠ æŒã€‚");
                    localStorage.setItem('gameCleared', 'true');
                    location.reload();
                } else {
                    alert("å›ç­”é”™è¯¯ã€‚ä½ é‡æ–°å å…¥å¹³åº¸çš„ç°å®ã€‚");
                    localStorage.setItem('gameCleared', 'false');
                    location.reload();
                }
            };
            btnEl.appendChild(btn);
        });
    }

    function renderScene(key) {
        if (key === "restart_with_reward") { 
            localStorage.setItem('gameCleared', 'true'); 
            location.reload(); 
            return; 
        }

        const scene = story[key];
        const textEl = document.getElementById('scene-text');
        const btnEl = document.getElementById('choice-buttons');
        
        if (scene.quiz) {
            triggerQuiz(scene.getText());
            return;
        }

        textEl.innerHTML = scene.getText();
        btnEl.innerHTML = '';

        if (state.mp <= 0) {
            triggerQuiz("âŒ ã€å¤±è´¥ã€‘è„‘åŠ›æ¯ç«­ã€‚ä½ åœ¨å¤æ‚çš„è®¡ç®—ä¸­é™·å…¥æ²‰ç¡ã€‚");
            return;
        }

        scene.getChoices().forEach(c => {
            const btn = document.createElement('button');
            btn.innerText = c.text;
            if (c.disabled) btn.disabled = true;
            btn.onclick = () => {
                if (c.effect) {
                    if (c.effect.mp) state.mp += c.effect.mp;
                    if (c.effect.item) state.item = c.effect.item;
                }
                state.step = c.next;
                updateStats();
                renderScene(c.next);
            };
            btnEl.appendChild(btn);
        });
    }

    updateStats();
    renderScene(0);
</script>
</body>
</html>
