<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„æŒ‘æˆ˜</title>
    <style>
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #0d1117; color: #c9d1d9; display: flex; justify-content: center; padding: 20px; line-height: 1.6; }
        #game-container { max-width: 700px; width: 100%; background: #161b22; padding: 30px; border-radius: 12px; border: 1px solid #30363d; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        h1 { color: #58a6ff; text-align: center; border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-top: 0; }
        .stats { display: flex; justify-content: space-between; background: #21262d; padding: 12px; border-radius: 6px; margin-bottom: 20px; color: #8b949e; font-size: 0.9em; }
        .content { font-size: 1.1em; margin-bottom: 25px; min-height: 180px; white-space: pre-wrap; }
        .choices { display: flex; flex-direction: column; gap: 12px; }
        button { background: #238636; color: white; border: 1px solid rgba(240,246,252,0.1); padding: 14px; border-radius: 6px; cursor: pointer; font-size: 1em; text-align: left; transition: 0.2s; }
        button:hover:not(:disabled) { background: #2ea043; transform: translateX(5px); }
        button:disabled { background: #30363d; color: #8b949e; cursor: not-allowed; opacity: 0.6; }
        .fail-text { color: #f85149; font-weight: bold; }
    </style>
</head>
<body>

<div id="game-container">
    <h1>å¼‚ç•Œç‰©ç†å­¦å®¶ï¼šçœŸç†çš„æŒ‘æˆ˜</h1>
    <div class="stats">
        <span>ğŸ§  è„‘åŠ› (MP): <span id="mp">100</span></span>
        <span>ğŸ’ è£…å¤‡: <span id="item">åˆå§‹åŒ–...</span></span>
        <span>ğŸ“ è¿›åº¦: <span id="step">1</span>/10</span>
    </div>
    <div id="scene-text" class="content"></div>
    <div id="choice-buttons" class="choices"></div>
</div>

<script>
    let hasCleared = localStorage.getItem('gameCleared') === 'true';
    let state = { mp: 100, item: hasCleared ? "è–„è·ç³–" : "ç‰©ç†è¯¾æœ¬", step: 1 };

    const story = {
        1: {
            getText: () => hasCleared ? "ä½ çš„é¢å‰ä»ç„¶æ˜¯ä¸€è„¸æ€€ç–‘çš„ç²¾çµå°‘å¥³è‰¾ç³ï¼Œä½†æ˜¯ä½ å‘ç°å£è¢‹é‡Œæœ‰ä¸€å—ã€è–„è·ç³–ã€‘ã€‚" : "ä½ é†’åœ¨å¼‚ç•Œï¼Œæ‰‹ä¸­åªæœ‰ä¸€æœ¬ç‰©ç†è¯¾æœ¬ã€‚ç¾ä¸½çš„ç²¾çµå°‘å¥³è‰¾ç³æ­£æ€€ç–‘åœ°çœ‹ç€ä½ ã€‚",
            getChoices: () => [
                { text: "å°è¯•ä¸å…¶æ²Ÿé€šå¹¶å±•ç¤ºè¯¾æœ¬å›¾ç”»", next: 2, effect: { mp: -5 } },
                { text: "åˆ©ç”¨å£è¢‹é‡Œçš„è–„è·ç³–å»ºç«‹åˆæ­¥ä¿¡ä»»", next: 2, effect: { mp: 15, item: "ç²¾çµçš„ä¿¡èµ–" }, disabled: !hasCleared }
            ]
        },
        2: {
            getText: () => "è‰¾ç³å‘Šè¯‰ä½ è¿™ä¸ªä¸–ç•Œå³å°†è¦è¢«é‚ªæ¶çš„æ­»çµæ³•å¸ˆè«å¾·é›·æ‘§æ¯ã€‚ä»–ä»¬åœ¨ç­‰å¾…å¼‚ä¸–ç•Œçš„å‹‡å£«æ•‘èµã€‚è¯æ²¡è¯´å®Œï¼Œä¸€åªæ¯èçŒçŠ¬è¢­æ¥ï¼è‰¾ç³å‡†å¤‡å°„ç®­ã€‚ä½ æ³¨æ„åˆ°ä¸Šæ–¹æ–œå¡æ‚¬æŒ‚ç€å·¨çŸ³ã€‚",
            getChoices: () => [
                { text: "å¯»æ‰¾æ”¯ç‚¹ï¼Œåˆ©ç”¨é•¿æœ¨æ’¬åŠ¨å·¨çŸ³", next: 3, effect: { mp: -5 } },
                { text: "ç›´æ¥å†²ä¸Šå‰å»å¸å¼•çŒçŠ¬æ³¨æ„", next: "fail_physics_1" }
            ]
        },
        3: {
            getText: () => "ä½ å’Œè‰¾ç³æˆåŠŸé€ƒå…¥çŸ®äººçš„çŸ¿é“ï¼Œå®ˆæŠ¤æœºç”²æ£€æµ‹åˆ°å…¥ä¾µã€‚å®ƒå‘å‡ºæœºæ¢°å™ªéŸ³ï¼Œç­‰å¾…é€»è¾‘è¾“å…¥ã€‚",
            getChoices: () => [
                { text: "è¾“å…¥ä¸€æ®µé€»è¾‘æ‚–è®ºä»£ç å°è¯•å¹²æ‰°å…¶é˜µåˆ—", next: 4, effect: { mp: -10 } },
                { text: "å°è¯•é€šè¿‡é‡‘å±å¯¼çº¿é€ æˆä¾›ç”µå•å…ƒçŸ­è·¯", next: 4, effect: { mp: -10, item: "ç£é“çŸ¿" } }
            ]
        },
        4: {
            getText: () => "çŸ®äººå·´æ—æƒŠè®¶äºä½ é«˜è¶…çš„çŸ¥è¯†ä¸æŠ€è‰ºï¼Œå¸¦ä½ æ¥åˆ°å·¥åŠã€‚ä»–å¸Œæœ›è·å¾—ä½ çš„å¸®åŠ©ã€‚å·¥åŠä¸­ç†”ç‚‰ç”±äºä»¥å¤ªå‹åŠ›è¿‡é«˜æ­£åœ¨å‰§çƒˆéœ‡åŠ¨ï¼",
            getChoices: () => [
                { text: "è®¾è®¡ä¸€ä¸ªå†·å‡åˆ†ç¦»å®¤ä»¥å¹³è¡¡å¾ªç¯ï¼ˆè·å¾—å¤–éª¨éª¼ï¼‰", next: 5, effect: { item: "è’¸æ±½å¤–éª¨éª¼", mp: 10 } }, // ä¿®æ­£ï¼šæ­£ç¡®æ“ä½œå°å¹…å›å¤MP
                { text: "æ‰‹åŠ¨æ—‹ç´§ä¿é™©é˜€é—¨ä»¥é˜»æ­¢å‹åŠ›å¤–æ³„", next: "fail_physics_2" }
            ]
        },
        5: {
            getText: () => "æ­»çµæ³•å¸ˆè«å¾·é›·æ­£åœ¨é©±ä½¿æŠ¥ä¸§é¸Ÿæ”»å‡»çŸ®äººçš„çŸ¿æ´ã€‚æ¶é­”åœ¨ç©ºä¸­ç›˜æ—‹ã€‚å·´æ—åˆ†ç»™ä½ ç®€æ˜“çˆ†ç‚¸ç‰©ã€‚ä½ éœ€è¦å†³å®šæŠ•æ·æ—¶æœºã€‚",
            getChoices: () => [
                { text: "ä¾æ®æŠ›ç‰©çº¿åŸç†åœ¨æŠ¥ä¸§é¸Ÿçˆ¬å‡ç‚¹é¢„åˆ¤æŠ•æ·", next: 6, effect: { mp: -5 } },
                { text: "ç›´æ¥ç„å‡†æŠ¥ä¸§é¸Ÿå¤´éƒ¨è¿›è¡Œé«˜é€Ÿç›´æŠ•", next: "fail_physics_3" }
            ]
        },
        6: {
            getText: () => "å‡»è´¥æŠ¥ä¸§é¸Ÿåï¼Œä½ ä»¬è¦å»æ­»çµæ³•å¸ˆè«å¾·é›·çš„åŸå ¡è¥æ•‘è¢«å›°çš„çŸ®äººé•¿è€ã€‚åŸå ¡å¤–æ˜¯ä¸€æ¡å‰§æ¯’çš„æŠ¤åŸæ²³ã€‚æ¯’æ²³æ¹æ€¥ã€‚æ ¹æ®æµä½“åŠ›å­¦ï¼Œä¸­å¿ƒæµé€Ÿæœ€å¿«ã€‚",
            getChoices: () => [
                { text: "åˆ¶ä½œå¸¦æœ‰é”¥å½¢æ•´æµç½©çš„ç®€æ˜“å–·æ°”å°èˆ¹ï¼Œè€—æ—¶è¾ƒä¹…", next: 7, effect: { mp: -5 } },
                { text: "ä¾é ä½“åŠ›å’Œè‰¾ç³çš„é­”æ³•ååŠ©å¿«é€Ÿæ³…æ¸¡", next: "fail_physics_4" }
            ]
        },
        7: {
            getText: () => "çŸ®äººé•¿è€è¢«å›°åœ¨ç¦é­”åŠ›åœºä¸­ã€‚åŠ›åœºè¡¨é¢æœ‰è§„å¾‹çš„ç”µæµè„‰åŠ¨ã€‚",
            getChoices: () => [
                { text: "ä½¿ç”¨é‡‘å±æ¡†æ¶æ„å»ºæ³•æ‹‰ç¬¬ç¬¼è¿›è¡Œé™ç”µå±è”½", next: 8, effect: { mp: -10 } },
                { text: "åˆ©ç”¨æç«¯æ¸©å·®å¯¼è‡´ææ–™ç–²åŠ³ä»è€Œç‰©ç†çˆ†ç ´", next: 8, effect: { mp: -10 } }
            ]
        },
        8: {
            getText: () => "è«å¾·é›·å‘ç°äº†ä½ ä»¬çš„è¡ŒåŠ¨ã€‚ä»–é‡Šæ”¾å¯’å†°ã€‚æ¸©åº¦æ€¥å‰§ä¸‹é™ï¼Œåˆ†å­åŠ¨èƒ½å‡ ä¹å½’é›¶ã€‚",
            getChoices: () => [
                { text: "å¯åŠ¨å¤–éª¨éª¼è¿‡è½½æ¨¡å¼åˆ©ç”¨æœºæ¢°æ‘©æ“¦ä¾›çƒ­ï¼Œå¤–éª¨éª¼å°†å½»åº•æŠ¥åºŸ", next: 9, effect: { mp: -10 }, disabled: state.item !== "è’¸æ±½å¤–éª¨éª¼" },
                { text: "ç‚¹ç‡ƒå‘¨å›´æ‰€æœ‰å¯ç‡ƒç‰©è¯•å›¾ç»´æŒç¯å¢ƒæ¸©åº¦", next: "fail_physics_6" }
            ]
        },
        9: {
            getText: () => "ä½ å‘ç°åŸå ¡æ ¸å¿ƒçš„é­”æ³•é˜µå…¶å®æ˜¯ä¸€ä¸ªæ­£åœ¨å…±æŒ¯çš„æ”¾å¤§å™¨ã€‚ä½ éœ€è¦å¯»æ‰¾å¹²æ¶‰ç‚¹ã€‚",
            getChoices: () => [
                { text: "å‘å°„åå‘ç›¸ä½æ³¢æŸåˆ¶é€ ç›¸æ¶ˆå¹²æ¶‰", next: 10, effect: { mp: -10 } },
                { text: "é€šè¿‡æå‡é­”æ³•è¾“å‡ºå°è¯•ç›´æ¥éœ‡ç¢æ”¾å¤§å™¨", next: "fail_physics_7" }
            ]
        },
        10: {
            getText: () => "è«å¾·é›·é™ä¸´ã€‚ç©ºé—´å¼€å§‹å´©å¡Œã€‚ä½ å‡†å¤‡å¦‚ä½•å›åº”è¿™æœ€ç»ˆçš„æŒ‘æˆ˜ï¼Ÿ",
            getChoices: () => [
                { text: "è¿ç”¨åŠ¨é‡å®ˆæ’ï¼Œåœ¨å¤–éª¨éª¼åŠ æŒä¸‹æ­£é¢ä¸€å‡»", next: "end_hero" },
                { text: "ä»¥ç‰©è´¨ä¸ºå¼•é‡Šæ”¾å¾®å‹æ ¸èšå˜ï¼ˆå›å½’ç»“å±€ï¼‰", next: "end_god" }
            ]
        },
        // ç»“å±€å¤„ç†
        "fail_physics_1": { getText: () => "âŒ ã€å¤±è´¥ã€‘ä½ è¢«çŒçŠ¬æ‰‘å€’ã€‚ç°ä»£ä¸–ç•Œçš„ä½ åœ¨ç‰©ç†è¯¾ä¸Šè¢«è€å¸ˆç‚¹åå«é†’äº†ã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "fail_physics_2": { getText: () => "âŒ ã€å¤±è´¥ã€‘å®¹å™¨å› å†…å‹ç¬é—´è¶…è¿‡æé™è€Œçˆ†è£‚ã€‚ä½ å›åˆ°äº†ç°å®ä¸–ç•Œï¼Œæ­£åœ¨è¿›è¡Œç‰©ç†æµ‹éªŒï¼Œè€ƒè¯•åªå‰©ä¸‹åäº”åˆ†é’Ÿè€Œä½ è¿˜æœ‰ä¸‰é“å¤§é¢˜æ²¡å†™ã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "fail_physics_3": { getText: () => "âŒ ã€å¤±è´¥ã€‘é‡åŠ›å¯¼è‡´ç‚¸å¼¹åœ¨æ¶é­”ä¸‹æ–¹è½ç©ºã€‚ä½ è¢«åŒæ¡Œæ‘‡é†’ï¼Œç­ä¸»ä»»ç«™åœ¨ä½ èº«åã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "fail_physics_4": { getText: () => "âŒ ã€å¤±è´¥ã€‘ç”±äºå¿½ç•¥äº†æµä½“é˜»åŠ›ï¼Œä½ è¢«æ¿€æµå·èµ°ã€‚ä½ å‘ç°è‡ªå·±åœ¨ç‰©ç†è¯¾ä¸Šç¡ç€äº†æµäº†ä¸€æ¡Œå­å£æ°´ã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "fail_physics_6": { getText: () => "âŒ ã€å¤±è´¥ã€‘ç”±äºçƒ­ä¼ å¯¼ç‡å¤ªä½ï¼Œç«ç„°æ— æ³•å¯¹æŠ—é­”æ³•å¯’å†·ã€‚ä½ å‘ç°è‡ªå·±ååœ¨æ•™å®¤çª—å£ï¼Œè¢«å†·é£å†»é†’ã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "fail_physics_7": { getText: () => "âŒ ã€å¤±è´¥ã€‘ç›²ç›®çš„èƒ½é‡è¾“å‡ºå¼•å‘äº†å…±æŒ¯å¤±æ§ï¼Œæ•´ç‰‡åŒºåŸŸåå¡Œäº†ã€‚ä½ åœ¨æ™šè‡ªä¹ ç¡ç€äº†ï¼Œè¢«å·¡é€»çš„è€å¸ˆç”¨ä¹¦æœ¬æ•²é†’ã€‚", choices: [{ text: "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)", next: "restart_no_reward" }] },
        "end_hero": { getText: () => "ğŸ›¡ï¸ã€ç»“å±€ï¼šé’¢é“è´¤è€…ã€‘ä½ å‡»è´¥äº†è«å¾·é›·å¹¶ç•™åœ¨äº†å¼‚ç•Œã€‚è™½ç„¶æ²¡èƒ½å¸¦ç€è–„è·ç³–å›å½’ï¼Œä½†ä½ æ˜¯è¿™é‡Œçš„è‹±é›„ã€‚", choices: [{ text: "å†æ¬¡å¼€å§‹å†’é™©", next: "restart_no_reward" }] },
        "end_god": { getText: () => "ğŸŒŒã€ç»“å±€ï¼šç‰©ç†çœŸç¥ã€‘ä½ æ”¹å†™äº†æ³•åˆ™ã€‚ä½ é†’åœ¨è¯¾æ¡Œå‰ï¼Œå£è¢‹é‡Œå¤šäº†ã€è–„è·ç³–ã€‘ï¼", choices: [{ text: "å¼€å¯çœŸç†äºŒå‘¨ç›®", next: "restart_with_reward" }] }
    };

    function updateStats() {
        document.getElementById('mp').innerText = state.mp;
        document.getElementById('item').innerText = state.item;
        document.getElementById('step').innerText = state.step;
    }

    function renderScene(key) {
        if (key === "restart_with_reward") { localStorage.setItem('gameCleared', 'true'); location.reload(); return; }
        if (key === "restart_no_reward") { location.reload(); return; }

        const scene = story[key];
        const textEl = document.getElementById('scene-text');
        const btnEl = document.getElementById('choice-buttons');
        
        textEl.innerHTML = scene.getText();
        btnEl.innerHTML = '';

        if (state.mp <= 0) {
            textEl.innerHTML = "âŒ <span class='fail-text'>ã€å¤±è´¥ã€‘è„‘åŠ›æ¯ç«­ã€‚</span>ä½ åœ¨å¤æ‚çš„è®¡ç®—ä¸­é™·å…¥æ²‰ç¡ã€‚";
            const btn = document.createElement('button');
            btn.innerText = "é‡å›åœ°çƒ (é‡æ–°å¼€å§‹)";
            btn.onclick = () => location.reload();
            btnEl.appendChild(btn);
            return;
        }

        scene.getChoices().forEach(c => {
            const btn = document.createElement('button');
            btn.innerText = c.text;
            if (c.disabled) btn.disabled = true;
            btn.onclick = () => {
                if (c.effect) {
                    if (c.effect.mp) state.mp += c.effect.mp;
                    if (c.effect.item) state.item = c.effect.item;
                }
                state.step = c.next;
                updateStats();
                renderScene(c.next);
            };
            btnEl.appendChild(btn);
        });
    }

    updateStats();
    renderScene(1);
</script>
</body>
</html>
